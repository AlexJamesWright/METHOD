<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>METHOD: FVS Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">METHOD
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classFVS.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classFVS-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FVS Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="fluxVectorSplitting_8h_source.html">fluxVectorSplitting.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FVS:</div>
<div class="dyncontent">
<div class="center"><img src="classFVS__inherit__graph.png" border="0" usemap="#FVS_inherit__map" alt="Inheritance graph"/></div>
<map name="FVS_inherit__map" id="FVS_inherit__map">
<area shape="rect" id="node2" href="classFluxMethod.html" title=" Abstract base class for any future flux methods &#160;" alt="" coords="5,5,96,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FVS:</div>
<div class="dyncontent">
<div class="center"><img src="classFVS__coll__graph.png" border="0" usemap="#FVS_coll__map" alt="Collaboration graph"/></div>
<map name="FVS_coll__map" id="FVS_coll__map">
<area shape="rect" id="node2" href="classFluxMethod.html" title=" Abstract base class for any future flux methods &#160;" alt="" coords="5,184,96,211"/>
<area shape="rect" id="node3" href="classModel.html" title=" Physics model that we want to use &#160;" alt="" coords="74,95,131,121"/>
<area shape="rect" id="node4" href="classData.html" title=" Data object &#160;" alt="" coords="25,5,76,32"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a81acca1eca284a13ff9ad7aea962050e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFVS.html#a81acca1eca284a13ff9ad7aea962050e">FVS</a> (<a class="el" href="classData.html">Data</a> *<a class="el" href="classFluxMethod.html#a19e6ef41b6cceb6840f0160a65c4140c">data</a>, <a class="el" href="classModel.html">Model</a> *<a class="el" href="classFluxMethod.html#a31f71afc31b5fd591339f84b9062b853">model</a>)</td></tr>
<tr class="separator:a81acca1eca284a13ff9ad7aea962050e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6baf18bec1b99a6eaa135be285dcaa31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFVS.html#a6baf18bec1b99a6eaa135be285dcaa31">fluxReconstruction</a> (double *cons, double *prims, double *aux, double *f, double *frecon, int dir)</td></tr>
<tr class="separator:a6baf18bec1b99a6eaa135be285dcaa31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60eeb88f17332b165df48cf6dee5c02b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFVS.html#a60eeb88f17332b165df48cf6dee5c02b">F</a> (double *cons, double *prims, double *aux, double *f, double *fnet)</td></tr>
<tr class="separator:a60eeb88f17332b165df48cf6dee5c02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classFluxMethod"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classFluxMethod')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classFluxMethod.html">FluxMethod</a></td></tr>
<tr class="memitem:a30c1177af42a3055ecab3d004cd3d074 inherit pub_methods_classFluxMethod"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFluxMethod.html#a30c1177af42a3055ecab3d004cd3d074">FluxMethod</a> (<a class="el" href="classData.html">Data</a> *<a class="el" href="classFluxMethod.html#a19e6ef41b6cceb6840f0160a65c4140c">data</a>, <a class="el" href="classModel.html">Model</a> *<a class="el" href="classFluxMethod.html#a31f71afc31b5fd591339f84b9062b853">model</a>)</td></tr>
<tr class="separator:a30c1177af42a3055ecab3d004cd3d074 inherit pub_methods_classFluxMethod"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_classFluxMethod"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classFluxMethod')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classFluxMethod.html">FluxMethod</a></td></tr>
<tr class="memitem:a19e6ef41b6cceb6840f0160a65c4140c inherit pub_attribs_classFluxMethod"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classData.html">Data</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFluxMethod.html#a19e6ef41b6cceb6840f0160a65c4140c">data</a></td></tr>
<tr class="separator:a19e6ef41b6cceb6840f0160a65c4140c inherit pub_attribs_classFluxMethod"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f71afc31b5fd591339f84b9062b853 inherit pub_attribs_classFluxMethod"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classModel.html">Model</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFluxMethod.html#a31f71afc31b5fd591339f84b9062b853">model</a></td></tr>
<tr class="separator:a31f71afc31b5fd591339f84b9062b853 inherit pub_attribs_classFluxMethod"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b> Flux vector splitting method </b> </p>
<dl class="section user"><dt></dt><dd>The flux vector splitting method, initial proposed in Shu 1997. Here, we use a second order WENO spatial reconstruction. <br />
 </dd></dl>
<dl class="section user"><dt></dt><dd>Here we outline the method briefly, but for a detailed explanation see the above citation. Ignoring any contributions to the conserved vector due to source terms we can define the system of conservation equations in the following form, <p class="formulaDsp">
\begin{align} \partial_t U + \partial_x f(U) = 0. \end{align}
</p>
 </dd></dl>
<dl class="section user"><dt></dt><dd>In essence we desire some numerical flux function \(\mathcal{F}\) such that we can update the conserved vector in the following way, <p class="formulaDsp">
\begin{align} \partial_t U = \mathcal{F}(U) \end{align}
</p>
 such that <p class="formulaDsp">
\begin{align} U^{n+1} =&amp; U^n + \mathcal{F}(U) \\ =&amp; U^n + \frac{f_{i+1/2} - f_{i-1/2}}{\Delta x} \end{align}
</p>
 where we define \(f_{i+1/2}\) as the value of the flux vector at the righthand edge of the \(i^{th}\) cell, and each cell has width \(\Delta x\). To determine the value of the numerical flux function then, we need estimates of the values of the flux vector at the cell faces. </dd></dl>
<dl class="section user"><dt></dt><dd>To get these, we consider the flux in cell \(i\) to be composed of entirely left moving and entirely right moving contributions, that is, <p class="formulaDsp">
\begin{align} f_i = f_i^- + f_i^+. \end{align}
</p>
 Using the Lax-Friedrichs approximation of the flux, we can ensure that these contributions are entirely poitive/negative by using the following, <p class="formulaDsp">
\begin{align} f_i^{\pm} = \frac{1}{2}(f_i \pm \alpha U_i) \end{align}
</p>
 where we have defined \(\alpha = max_p|\lambda_p|\) is the maximum wavespeed with \(\lambda_p\) as the \(p^th\) eigenvalue of the Jacobian of the system. </dd></dl>
<dl class="section user"><dt></dt><dd>For simplicity, we note that in a system with electromagnetic perturbations, waves travel at the speed of light, and thus we set \(alpha=1\) throughout. To determine the flux vector at the cell faces, we reconstruct both upwind and downwind fluxes and compute the difference of the two at the face. We do this with a second order WENO reconstruction, thus, <p class="formulaDsp">
\begin{align} f^+_{i, right} &amp;= WENO(f_{i-2}, f_{i-1}, f_i) \\ f^-_{i, left} &amp;= WENO(f_{i+1}, f_i, f_{i-1}) \end{align}
</p>
 so that the reconstruction if \(f_{i+1/2} = f^+_{i, right} + f^-_{i, left}\). Note that this final equation is essentially a difference equation as the fluxes are moving in opposing directions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="fluxVectorSplitting_8h_source.html#l00062">62</a> of file <a class="el" href="fluxVectorSplitting_8h_source.html">fluxVectorSplitting.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a81acca1eca284a13ff9ad7aea962050e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81acca1eca284a13ff9ad7aea962050e">&#9670;&nbsp;</a></span>FVS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FVS::FVS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classData.html">Data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classModel.html">Model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Calls the base class constructor to store pointers to <a class="el" href="classData.html" title=" Data object  ">Data</a> and <a class="el" href="classModel.html" title=" Physics model that we want to use  ">Model</a> classes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*data</td><td>pointer to <a class="el" href="classData.html" title=" Data object  ">Data</a> class </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*model</td><td>pointer to <a class="el" href="classModel.html" title=" Physics model that we want to use  ">Model</a> class </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="fluxVectorSplitting_8h_source.html#l00074">74</a> of file <a class="el" href="fluxVectorSplitting_8h_source.html">fluxVectorSplitting.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a60eeb88f17332b165df48cf6dee5c02b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60eeb88f17332b165df48cf6dee5c02b">&#9670;&nbsp;</a></span>F()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FVS::F </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>fnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Numerical flux function. </p>
<p>For a given state described by cons prims and aux arrays, determines an approximation of the net flux of the conserved quantities through all cells by taking difference of the reconstructed values at the cell faces.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*cons</td><td>pointer to conserved vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*prims</td><td>pointer to primitive vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*aux</td><td>pointer to auxilliary vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*f</td><td>pointer to a flux work array to store the initial flux vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*fnet</td><td>pointer to the array containing the net flux through every cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classFVS.html#a6baf18bec1b99a6eaa135be285dcaa31" title="Flux reconstruction. ">fluxReconstruction</a> </dd></dl>

<p>Implements <a class="el" href="classFluxMethod.html#a5c55691e82aca8516782912d3aa5d474">FluxMethod</a>.</p>

</div>
</div>
<a id="a6baf18bec1b99a6eaa135be285dcaa31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6baf18bec1b99a6eaa135be285dcaa31">&#9670;&nbsp;</a></span>fluxReconstruction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FVS::fluxReconstruction </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>frecon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flux reconstruction. </p>
<p>Reconstructs the fluxes at the center of the cells to the faces upwind and downwind and computes the difference, giving an approximation of the net flux (in the specified direction) at the cell faces. Method uses a second order WENO reconstruction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*cons</td><td>pointer to conserved vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*prims</td><td>pointer to primitive vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*aux</td><td>pointer to auxilliary vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*f</td><td>pointer to a flux work array to store the initial flux vector </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*frecon</td><td>pointer to the array containing the reconstructed values of the fluxes at the cell faces </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">dir</td><td>the direction in which to determine flux reconstruction with (0, 1, 2) = (x, y, z) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is an approximation of the net flux at the cell faces, not the cell centers, and so the final approximation of the flux through a cell required differencing the values obtained here at either end of the cell. This is performed in F </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classFVS.html#a60eeb88f17332b165df48cf6dee5c02b" title="Numerical flux function. ">F</a> </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="fluxVectorSplitting_8h_source.html">fluxVectorSplitting.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classFVS.html">FVS</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
